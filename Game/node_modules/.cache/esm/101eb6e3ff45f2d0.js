let Curso,Area,Partida,sequelize,QueryTypes;_ff4‍.x([["default",()=>_ff4‍.o]]);_ff4‍.w("../models/index",[["Curso",["Curso"],function(v){Curso=v}],["Area",["Area"],function(v){Area=v}],["Partida",["Partida"],function(v){Partida=v}],["sequelize",["sequelize"],function(v){sequelize=v}]]);_ff4‍.w("sequelize",[["QueryTypes",["QueryTypes"],function(v){QueryTypes=v}]]);


const index = (req, res) => {
    res.render('jogo/game', {
        csrf: req.csrfToken(),
        userId: req.session.uid
    })
}

const ranking = async (req, res) => {
    const ranking = await sequelize.query(`\
    SELECT
	    nome as nome,
        pontuacao as pontuacao
    
    From
	    users, partidas
    WHERE
	    users.id = partidas.userId 
    ORDER BY pontuacao DESC
        ;`, { type: QueryTypes.SELECT });
    res.render("jogo/ranking", { partidas: ranking });
}

const save = async (req, res) => {
    if (req.route.methods.post) {
        try {
            await Partida.create(req.body);
            res.redirect('/');
        } catch (errors) {
            res.render('curso/', {
                csrf: req.csrfToken(),
            })
        }
    }
}


_ff4‍.d({ index, ranking, save });